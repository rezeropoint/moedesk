# MoeDesk å¼€å‘è®¡åˆ’

## é¡¹ç›®æ¦‚è¿°

MoeDesk æ˜¯ä¸€ä¸ªäºŒæ¬¡å…ƒè·¨å¢ƒç”µå•†ç¤¾åª’è¿è¥å·¥ä½œå°ï¼Œæ ¸å¿ƒåŠŸèƒ½ï¼šç»Ÿä¸€ç®¡ç†å¤šå¹³å°æ¶ˆæ¯ã€AI è¾…åŠ©å†…å®¹ç”Ÿæˆã€å·¥ä½œæµè‡ªåŠ¨åŒ–ã€‚

---

## åŠŸèƒ½æ¨¡å—è¿›åº¦

| æ¨¡å— | è·¯ç”± | çŠ¶æ€ |
|-----|------|------|
| ç”¨æˆ·è®¤è¯ | `/login` | âœ… å·²å®Œæˆ |
| ç”¨æˆ·ç®¡ç† | `/admin/users` | âœ… å·²å®Œæˆ |
| å·¥ä½œæµé…ç½® | `/workflows` | âœ… å·²å®Œæˆ |
| **çƒ­ç‚¹é›·è¾¾** | `/trending` | âœ… å·²å®Œæˆ |
| **çƒ­åº¦åˆ†æ** | `/trending/analytics` | âœ… å·²å®Œæˆ |
| **å‘å¸ƒä¸­å¿ƒ** | `/publish` | âœ… å·²å®Œæˆ |
| **è´¦å·ç®¡ç†** | `/settings/accounts` | âœ… å·²å®Œæˆï¼ˆå« YouTube OAuthï¼‰ |
| æ¶ˆæ¯ä¸­å¿ƒ | `/inbox` | â³ å¾…å¼€å‘ |
| å†…å®¹æ—¥å† | `/content` | â³ å¾…å¼€å‘ |
| æ•°æ®æŠ¥è¡¨ | `/analytics` | â³ å¾…å¼€å‘ |

---

## æ•°æ®æ¨¡å‹

### æ ¸å¿ƒè¡¨

| è¡¨å | è¯´æ˜ | å…³é”®å­—æ®µ |
|------|------|---------|
| `series` | IP ç³»åˆ—ï¼ˆå¦‚ï¼šé¬¼ç­ä¹‹åˆƒæ•´ä½“ï¼‰ | type, titleOriginal, aggregatedScore |
| `entries` | IP æ¡ç›®ï¼ˆå•å­£/å•ä½œå“ï¼‰ | seriesId, totalScore, status |
| `trendings` | çƒ­åº¦è¿½è¸ªï¼ˆå…³è”ç³»åˆ—ï¼‰ | seriesId, redditKarma, googleTrend |
| `trending_history` | çƒ­åº¦å†å²ï¼ˆTimescaleDBï¼‰ | trendingId, source, popularity |
| `social_accounts` | ç¤¾åª’è´¦å· | platform, accountName, status |
| `publish_task_accounts` | ä»»åŠ¡è´¦å·å…³è” | taskId, accountId |

### å…³ç³»è®¾è®¡

```
Series (ç³»åˆ—)
  â”œâ”€â”€ Entry[] (å¤šä¸ªå­£åº¦/ä½œå“)
  â””â”€â”€ Trending (ç³»åˆ—çº§çƒ­åº¦è¿½è¸ª)
        â””â”€â”€ TrendingHistory[] (æ—¶åºæ•°æ®)
```

### æšä¸¾ç±»å‹

| æšä¸¾ | å€¼ |
|------|-----|
| `IpType` | ANIME, GAME, MANGA, LIGHT_NOVEL, VTUBER, MOVIE, OTHER |
| `ReviewStatus` | PENDING, APPROVED, REJECTED |
| `TrendingStatus` | WATCHING, FOCUSED, IN_PROGRESS, ARCHIVED |
| `TrendingSource` | GOOGLE_TRENDS, REDDIT, TWITTER, BILIBILI, ANILIST |

---

## API è·¯ç”±

| è·¯å¾„ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/series` | GET/POST | ç³»åˆ—åˆ—è¡¨/åˆ›å»º |
| `/api/series/search` | GET | ç³»åˆ—æœç´¢ |
| `/api/series/[id]` | GET/PATCH/DELETE | ç³»åˆ—è¯¦æƒ…/æ›´æ–°/åˆ é™¤ |
| `/api/entries` | GET | æ¡ç›®åˆ—è¡¨ |
| `/api/entries/[id]` | GET/PATCH | æ¡ç›®è¯¦æƒ…/æ›´æ–° |
| `/api/entries/[id]/approve` | POST | å®¡æ ¸é€šè¿‡ |
| `/api/entries/[id]/reject` | POST | å®¡æ ¸æ‹’ç» |
| `/api/entries/[id]/revoke` | POST | æ’¤é”€å®¡æ ¸ï¼ˆADMINï¼‰ |
| `/api/entries/parse-title` | POST | æ ‡é¢˜è§£æé¢„è§ˆ |
| `/api/trendings` | GET | çƒ­åº¦åˆ—è¡¨ |
| `/api/trendings/surge` | GET | çƒ­åº¦é£™å‡ |
| `/api/trendings/search` | GET | IP æœç´¢ |
| `/api/trendings/analytics/history` | GET | å†å²æ—¶åºæ•°æ® |
| `/api/trendings/analytics/compare` | GET | å˜åŒ–ç‡å¯¹æ¯” |
| `/api/trendings/analytics/sources` | GET | æ•°æ®æºåˆ†æ |
| `/api/configs/[key]` | GET/PUT | é…ç½®è¯»å†™ |
| `/api/workflows` | GET | å·¥ä½œæµåˆ—è¡¨ |
| `/api/workflows/[id]/toggle` | PATCH | åˆ‡æ¢å·¥ä½œæµå¯ç”¨çŠ¶æ€ |
| `/api/accounts` | GET/POST | è´¦å·åˆ—è¡¨/åˆ›å»º |
| `/api/accounts/stats` | GET | è´¦å·ç»Ÿè®¡ |
| `/api/accounts/[id]` | GET/PATCH/DELETE | è´¦å·è¯¦æƒ…/æ›´æ–°/åˆ é™¤ |
| `/api/accounts/[id]/toggle-status` | POST | å¯ç”¨/ç¦ç”¨è´¦å· |
| `/api/accounts/[id]/refresh-token` | POST | åˆ·æ–° OAuth Token |
| `/api/accounts/by-platform/[platform]` | GET | æŒ‰å¹³å°è·å–è´¦å·ï¼ˆå« hasChannelï¼‰ |
| `/api/youtube/categories` | GET | YouTube è§†é¢‘åˆ†ç±»åˆ—è¡¨ |
| `/api/youtube/playlists` | GET | YouTube æ’­æ”¾åˆ—è¡¨ï¼ˆéœ€ accountIdï¼‰ |
| `/api/oauth/youtube/authorize` | GET | YouTube OAuth æˆæƒå‘èµ· |
| `/api/oauth/youtube/callback` | GET | YouTube OAuth å›è°ƒå¤„ç† |
| `/api/oauth/youtube/confirm-channels` | POST | ç¡®è®¤å¤šé¢‘é“é€‰æ‹© |

---

## ç›‘æµ‹è®¾ç½®é¢æ¿ - 2025-12-29 å®Œæˆ

çƒ­ç‚¹é›·è¾¾å³ä¾§çš„"ç›‘æµ‹è®¾ç½®"å¡ç‰‡ï¼Œç”¨äºæ§åˆ¶ n8n å·¥ä½œæµçš„å¯ç”¨/ç¦ç”¨ã€‚

### åŠŸèƒ½æ¸…å•

- [x] æ˜¾ç¤ºçƒ­ç‚¹ç›‘æµ‹ç›¸å…³å·¥ä½œæµï¼ˆAniList/Reddit/Google Trendsï¼‰
- [x] æ¯ä¸ªå·¥ä½œæµæ˜¾ç¤ºï¼šåç§°ã€è§¦å‘æ—¶é—´ã€çŠ¶æ€å¼€å…³ã€ç¼–è¾‘é“¾æ¥
- [x] å¼€å…³è°ƒç”¨ n8n API `/activate` å’Œ `/deactivate` ç«¯ç‚¹
- [x] ç¼–è¾‘æŒ‰é’®è·³è½¬ n8n ç¼–è¾‘å™¨
- [x] æœªé…ç½®çš„å·¥ä½œæµæ˜¾ç¤º"æœªé…ç½®"å¾½ç« ï¼Œå¼€å…³ç¦ç”¨
- [x] æƒé™æ§åˆ¶ï¼šä»… ADMIN è§’è‰²å¯æ“ä½œ

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `components/ui/switch.tsx` | æ–°å¢ | shadcn/ui Switch ç»„ä»¶ |
| `lib/n8n.ts` | ä¿®æ”¹ | æ–°å¢ `toggleN8NWorkflow` å‡½æ•° |
| `app/api/workflows/[id]/toggle/schema.ts` | æ–°å¢ | API Schema |
| `app/api/workflows/[id]/toggle/route.ts` | æ–°å¢ | åˆ‡æ¢å·¥ä½œæµçŠ¶æ€ API |
| `components/trending/monitor-settings-panel.tsx` | é‡å†™ | ç›‘æµ‹è®¾ç½®é¢æ¿ç»„ä»¶ |
| `.env` | ä¿®æ”¹ | æ·»åŠ  `NEXT_PUBLIC_N8N_URL` |

### ä½¿ç”¨å‰æ

ç¡®ä¿ `N8N_API_KEY` å·²åœ¨ `.env` ä¸­é…ç½®ï¼Œå¦åˆ™å·¥ä½œæµå°†æ˜¾ç¤ºä¸º"æœªé…ç½®"çŠ¶æ€ã€‚

---

## n8n å·¥ä½œæµ

| æ–‡ä»¶ | è§¦å‘æ–¹å¼ | åŠŸèƒ½ |
|------|---------|------|
| `sop-01-anilist-sync.json` | æ¯å‘¨ä¸€ 09:00 | AniList æ–°ç•ªåŒæ­¥ â†’ entries |
| `sop-02-popularity-refresh.json` | æ¯å¤© 03:00 | çƒ­åº¦å…¨é‡åˆ·æ–° |
| `sop-02-google-trends.json` | æ¯å¤© 04:00 | Google Trends é‡‡é›† |
| `sop-02-reddit-monitor.json` | æ¯å¤© 05:00 | Reddit Karma é‡‡é›† |

### å®¡æ ¸æµç¨‹

```
n8n åŒæ­¥ â†’ entries (PENDING)
              â”‚
              â–¼
         äººå·¥å®¡æ ¸
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                   â–¼
  é€šè¿‡                 æ‹’ç»
    â”‚
    â–¼
é€‰æ‹©/åˆ›å»º Series + åˆ›å»º Trending
    â”‚
    â–¼
å®æ—¶çƒ­ç‚¹æ˜¾ç¤º
```

---

## æŠ€æœ¯æ ˆ

- **å‰ç«¯**ï¼šNext.js 16 + React 19 + TypeScript + Tailwind CSS v4 + shadcn/ui
- **æ•°æ®åº“**ï¼šTimescaleDB + Prisma ORM
- **å·¥ä½œæµ**ï¼šn8n (Docker)
- **è®¤è¯**ï¼šJWT + Session

---

## ç¯å¢ƒé…ç½®

```env
DATABASE_URL="postgresql://postgres:postgres@localhost:15432/moedesk"
JWT_SECRET="your-secret-key"
N8N_WEBHOOK_URL="http://localhost:5678"
N8N_API_KEY=""                              # n8n API Keyï¼ˆå·¥ä½œæµæ§åˆ¶å¿…éœ€ï¼‰
NEXT_PUBLIC_N8N_URL="http://localhost:5678" # å®¢æˆ·ç«¯å¯è®¿é—®çš„ n8n åœ°å€
```

---

## çƒ­åº¦åˆ†æé¡µé¢ - 2025-12-29 å®Œæˆ

ä½¿ç”¨ Recharts å›¾è¡¨åº“å®ç°çš„çƒ­åº¦æ•°æ®åˆ†æé¡µé¢ã€‚

### åŠŸèƒ½æ¸…å•

- [x] æ—¶åºè¶‹åŠ¿å›¾ï¼šå¤š IP çƒ­åº¦å˜åŒ–æ›²çº¿ï¼ˆ7/30/90å¤©ï¼‰
- [x] å˜åŒ–ç‡æŸ±çŠ¶å›¾ï¼šå„ IP å˜åŒ–ç‡å¯¹æ¯”
- [x] æ•°æ®æºé¥¼å›¾ï¼šè´¡çŒ®åº¦åˆ†æ
- [x] å…³é”®æŒ‡æ ‡å¡ç‰‡ï¼šå¹³å‡å˜åŒ–ç‡ã€æœ€çƒ­ IPã€æ•°æ®æºè¦†ç›–
- [x] IP å¤šé€‰å™¨ï¼šæœç´¢æ·»åŠ ï¼Œæœ€å¤š 5 ä¸ª
- [x] æ•°æ®æºåˆ‡æ¢ï¼šç»¼åˆ/Reddit/Google/AniList/Twitter/Bilibili

### æ–°å¢æ–‡ä»¶

| ç›®å½• | æ–‡ä»¶æ•° | è¯´æ˜ |
|------|--------|------|
| `app/api/trendings/search/` | 2 | IP æœç´¢ API |
| `app/api/trendings/analytics/` | 6 | åˆ†æ APIï¼ˆhistory/compare/sourcesï¼‰ |
| `components/trending/analytics/` | 8 | åˆ†æé¡µç»„ä»¶ |
| `types/analytics.ts` | 1 | ç±»å‹å®šä¹‰ |

---

## çƒ­åº¦åˆ†æåˆ†å±‚å±•ç¤ºæ”¹é€  - 2025-12-30 å®Œæˆ

è§£å†³ä¸åŒç¤¾åª’æ•°æ®æºæ•°å€¼ç»´åº¦å·®å¼‚é—®é¢˜ï¼ˆAniList 0-100 vs Bilibili æ•°ç™¾ä¸‡ï¼‰ã€‚

### é—®é¢˜èƒŒæ™¯

| æ•°æ®æº | å…¸å‹èŒƒå›´ | åŸæœ‰é—®é¢˜ |
|--------|---------|---------|
| ANILIST rating | 0-100 | è¢«é«˜æ•°å€¼æºæ·¹æ²¡ |
| GOOGLE_TRENDS | 0-100 | è¢«é«˜æ•°å€¼æºæ·¹æ²¡ |
| REDDIT | æ•°ç™¾ï½æ•°åƒ | ä¸­ç­‰ |
| TWITTER | æ•°ç™¾ï½æ•°åƒ | ä¸­ç­‰ |
| BILIBILI | æ•°åƒï½æ•°ç™¾ä¸‡ | å®Œå…¨å‹åˆ¶å…¶ä»–æº |

### è§£å†³æ–¹æ¡ˆ

1. **è¶‹åŠ¿çº¿å›¾æ”¹é€ **
   - ç»¼åˆæ¨¡å¼ï¼šå„æ•°æ®æºå½’ä¸€åŒ–åˆ° 0-100 åç”¨é¢ç§¯å›¾å±•ç¤º
   - å•æºæ¨¡å¼ï¼šä¿æŒåŸå§‹å€¼æŠ˜çº¿å›¾å¯¹æ¯”

2. **é¥¼å›¾â†’é›·è¾¾å›¾**
   - ç”¨æ´»è·ƒåº¦åˆ†æ•°ï¼ˆå½’ä¸€åŒ– 0-100ï¼‰æ›¿ä»£ç»å¯¹å€¼
   - å±•ç¤ºå„æ•°æ®æºçš„ç›¸å¯¹å¼ºåº¦
   - æ·»åŠ æ•°æ®è¦†ç›–ç‡æŒ‡ç¤ºå™¨

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `lib/normalize.ts` | æ–°å¢ | å½’ä¸€åŒ–å·¥å…·å‡½æ•° |
| `types/analytics.ts` | ä¿®æ”¹ | æ–°å¢å½’ä¸€åŒ–ç›¸å…³ç±»å‹ |
| `components/trending/analytics/trend-line-chart.tsx` | é‡å†™ | ç»¼åˆæ¨¡å¼å½’ä¸€åŒ–é¢ç§¯å›¾ |
| `components/trending/analytics/source-radar-chart.tsx` | æ–°å¢ | é›·è¾¾å›¾ç»„ä»¶ |
| `components/trending/analytics/analytics-container.tsx` | ä¿®æ”¹ | ä½¿ç”¨æ–°ç»„ä»¶ |

### å½’ä¸€åŒ–ç®—æ³•ï¼ˆå·²åºŸå¼ƒï¼‰

åŸæ–¹æ¡ˆä½¿ç”¨å½“å‰æŸ¥è¯¢æ•°æ®çš„ min/maxï¼Œå¯¼è‡´æ— æ³•è·¨ç•ªå‰§æ¯”è¾ƒã€‚

---

## çƒ­åº¦åˆ†æå…¨å±€å½’ä¸€åŒ–æ”¹é€  - 2025-12-30 å®Œæˆ

ä¼˜åŒ–å½’ä¸€åŒ–ç®—æ³•ï¼Œä½¿ç”¨å…¨å±€å†å²æ•°æ®ä½œä¸ºå‚è€ƒèŒƒå›´ï¼Œå®ç°è·¨ç•ªå‰§çš„çœŸå®çƒ­åº¦æ¯”è¾ƒã€‚

### é—®é¢˜èƒŒæ™¯

| é—®é¢˜ | æè¿° |
|------|------|
| æ— æ³•è·¨ç•ªå‰§æ¯”è¾ƒ | åªé€‰ä¸€ä¸ª IP æ—¶ï¼Œå…¶ min=0, max=100ï¼Œæ— æ³•ä¸å…¶ä»–ç•ªå‰§æ¯”è¾ƒ |
| æ—¶é—´èŒƒå›´è·³å˜ | åˆ‡æ¢ 7/30/90 å¤©æ—¶ï¼ŒåŒä¸€æ•°æ®çš„å½’ä¸€åŒ–å€¼ä¼šè·³å˜ |
| AniList å­˜å‚¨é—®é¢˜ | å·¥ä½œæµå­˜å‚¨çš„æ˜¯åŸå§‹ popularity å€¼ï¼ˆ0-500,000+ï¼‰ï¼Œä¸æ˜¯å½’ä¸€åŒ–å€¼ |

### æ•°æ®æºå­˜å‚¨æ ¼å¼

| æ•°æ®æº | å­˜å‚¨å€¼ | èŒƒå›´ | å¤‡æ³¨ |
|--------|--------|------|------|
| GOOGLE_TRENDS | åŸå€¼ | 0-100 | Google å®˜æ–¹æ ‡å‡†åŒ–ï¼Œæ— éœ€å¤„ç† |
| ANILIST | åŸå€¼ | 0-500,000+ | å·¥ä½œæµå­˜å‚¨åŸå§‹ popularityï¼Œéœ€å½’ä¸€åŒ– |
| REDDIT | åŸå€¼ | 0-50,000+ | ä¸€å‘¨å†…å¸–å­ karma ç´¯è®¡ï¼Œéœ€å½’ä¸€åŒ– |
| TWITTER | åŸå€¼ | å¾…å®š | æœªå®ç° |
| BILIBILI | åŸå€¼ | å¾…å®š | æœªå®ç° |

### è§£å†³æ–¹æ¡ˆ

1. **å…¨å±€å‚è€ƒèŒƒå›´**
   - åç«¯ API æŸ¥è¯¢å„æ•°æ®æºçš„**å…¨éƒ¨å†å²æœ€å¤§å€¼**
   - è¿”å› `globalRanges` å­—æ®µä¾›å‰ç«¯ä½¿ç”¨

2. **å½’ä¸€åŒ–ç­–ç•¥**
   - å·²æ ‡å‡†åŒ–æ•°æ®æºï¼ˆä»… GOOGLE_TRENDSï¼‰ï¼šç›´æ¥ä½¿ç”¨åŸå€¼
   - å…¶ä»–æ•°æ®æºï¼šä½¿ç”¨ `min(value / globalMax * 100, 100)` å½’ä¸€åŒ–

### å½’ä¸€åŒ–å…¬å¼

```typescript
// ä½¿ç”¨å…¨å±€å†å²æœ€å¤§å€¼å½’ä¸€åŒ–
normalizedValue = min((value / globalMax) * 100, 100)

// globalMax æ¥è‡ª SQL æŸ¥è¯¢
SELECT source, MAX(popularity) as max_value
FROM trending_history
WHERE popularity > 0
GROUP BY source
```

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `app/api/trendings/analytics/history/route.ts` | ä¿®æ”¹ | æŸ¥è¯¢å¹¶è¿”å› globalRanges |
| `types/analytics.ts` | ä¿®æ”¹ | æ–°å¢ GlobalSourceRange ç±»å‹ |
| `lib/normalize.ts` | ä¿®æ”¹ | æ–°å¢ normalizeWithGlobalRanges å‡½æ•° |
| `components/trending/analytics/analytics-container.tsx` | ä¿®æ”¹ | ç®¡ç† globalRanges çŠ¶æ€ |
| `components/trending/analytics/trend-line-chart.tsx` | ä¿®æ”¹ | ä½¿ç”¨æ–°å½’ä¸€åŒ–å‡½æ•° |

### æ•ˆæœ

- ç•ªå‰§ A (Reddit 5000) vs ç•ªå‰§ B (Reddit 8000) å¯åœ¨åŒä¸€åæ ‡ç³»çœŸå®æ¯”è¾ƒ
- åˆ‡æ¢æ—¶é—´èŒƒå›´æ—¶å½’ä¸€åŒ–å€¼ä¿æŒç¨³å®š
- çªç ´å†å²çºªå½•çš„ç•ªå‰§æ˜¾ç¤ºä¸º 100ï¼ˆæˆªæ–­ï¼‰

---

## ç•ªå‰§IPå’Œå¤šå­£åŠŸèƒ½å®Œå–„ - 2025-12-30 å®Œæˆ

è§£å†³å®¡æ ¸æµç¨‹ä¸­ IP åç§°å’Œå¤šå­£å…³è”çš„é—®é¢˜ã€‚

### é—®é¢˜èƒŒæ™¯

| é—®é¢˜ | æè¿° |
|------|------|
| å·²å®¡æ ¸æ— æ³•ä¿®æ”¹ | å®¡æ ¸é€šè¿‡åæ— æ³•ä¿®æ”¹å…³è”å…³ç³»æˆ–æ’¤é”€ |
| å¤šå­£åç§°é—®é¢˜ | å…ˆæ·»åŠ "é¬¼ç­ä¹‹åˆƒ ç¬¬äºŒå­£"ä¼šåˆ›å»ºåŒåç³»åˆ— |
| å­£åº¦æ£€é‡ç¼ºå¤± | åŒä¸€ç³»åˆ—å¯èƒ½å‡ºç°ä¸¤ä¸ª"ç¬¬2å­£" |
| æ—¥æœŸæ˜¾ç¤ºä¸å‡† | çƒ­ç‚¹åˆ—è¡¨æ˜¾ç¤ºæœ€é«˜åˆ†å­£æ—¥æœŸè€Œéæœ€æ–°å­£ |

### è§£å†³æ–¹æ¡ˆ

1. **æ ‡é¢˜è§£æå·¥å…·**
   - ä»"é¬¼ç­ä¹‹åˆƒ ç¬¬äºŒå­£"æå–åŸºç¡€åç§°"é¬¼ç­ä¹‹åˆƒ"
   - æ”¯æŒä¸­æ–‡å­£åº¦ï¼ˆç¬¬ä¸€å­£ï¼‰ã€è‹±æ–‡å­£åº¦ï¼ˆSeason 1/S1ï¼‰ã€ç‰¹æ®Šå½¢å¼ï¼ˆå‰§åœºç‰ˆ/OVAï¼‰
   - ä½ç½®ä¿¡åº¦æ—¶æç¤ºç”¨æˆ·ç¡®è®¤

2. **å®¡æ ¸æµç¨‹ä¼˜åŒ–**
   - åˆ›å»ºæ–°ç³»åˆ—æ—¶ä½¿ç”¨åŸºç¡€åç§°è€Œéå®Œæ•´æ ‡é¢˜
   - è‡ªåŠ¨å¡«å…… seasonNumber å’Œ seasonLabel
   - å­£åº¦ç¼–å·æ£€é‡

3. **å·²å®¡æ ¸ä¿®æ”¹èƒ½åŠ›**
   - æ’¤é”€å®¡æ ¸ APIï¼ˆADMIN é™åˆ¶ï¼‰
   - ä¿®æ”¹å…³è”ç³»åˆ—å’Œå­£åº¦
   - ç®¡ç†æ¡ç›®å…¥å£ï¼ˆçƒ­ç‚¹è¯¦æƒ…å¼¹çª—ï¼‰

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `lib/title-parser.ts` | æ–°å¢ | æ ‡é¢˜è§£æå·¥å…·å‡½æ•° |
| `app/api/entries/[id]/revoke/route.ts` | æ–°å¢ | æ’¤é”€å®¡æ ¸ API |
| `app/api/entries/parse-title/route.ts` | æ–°å¢ | æ ‡é¢˜è§£æé¢„è§ˆ API |
| `components/trending/series-entries-manager.tsx` | æ–°å¢ | ç³»åˆ—æ¡ç›®ç®¡ç†å™¨ |
| `components/ui/alert-dialog.tsx` | æ–°å¢ | shadcn ç¡®è®¤å¼¹çª— |
| `app/api/entries/schema.ts` | ä¿®æ”¹ | æ‰©å±• ApproveReq/UpdateReq |
| `app/api/entries/[id]/approve/route.ts` | ä¿®æ”¹ | é›†æˆåç§°è§£æå’Œæ£€é‡ |
| `app/api/entries/[id]/route.ts` | ä¿®æ”¹ | æ‰©å±• PATCH æ”¯æŒå…³è”ä¿®æ”¹ |
| `app/api/trendings/route.ts` | ä¿®æ”¹ | æ—¥æœŸæŒ‰æœ€æ–°å­£æ˜¾ç¤º |
| `components/trending/entry-item.tsx` | ä¿®æ”¹ | å®¡æ‰¹å¼¹çª—æ·»åŠ ç³»åˆ—åç§°ç¼–è¾‘ |
| `components/trending/trending-item.tsx` | ä¿®æ”¹ | æ·»åŠ ç®¡ç†æ¡ç›®å…¥å£ |

### æ“ä½œè·¯å¾„

```
çƒ­ç‚¹é›·è¾¾ â†’ ç‚¹å‡»"è¯¦æƒ…" â†’ ç®¡ç†æ¡ç›®æŒ‰é’®
  â”œâ”€â”€ æŸ¥çœ‹ç³»åˆ—ä¸‹æ‰€æœ‰å·²å®¡æ ¸ Entry
  â”œâ”€â”€ âš™ï¸ ç¼–è¾‘ï¼ˆä¿®æ”¹ç³»åˆ—/å­£åº¦ï¼‰
  â””â”€â”€ â†©ï¸ æ’¤é”€å®¡æ ¸ï¼ˆé‡ç½®ä¸ºå¾…å®¡æ ¸ï¼‰
```

---

## çƒ­ç‚¹é›·è¾¾ UI å±‚çº§ä¼˜åŒ– - 2025-12-30 å®Œæˆ

ä¼˜åŒ–çƒ­ç‚¹åˆ—è¡¨çš„ç³»åˆ—ä¸å­£åº¦å±•ç¤ºæ–¹å¼ï¼Œæ¸…æ™°è¡¨è¾¾æ•°æ®ç²’åº¦ã€‚

### é—®é¢˜èƒŒæ™¯

| é—®é¢˜ | æè¿° |
|------|------|
| å±‚çº§ä¸æ¸… | ç›´æ¥å±•ç¤ºç³»åˆ—çº§æ•°æ®ï¼Œæœªä½“ç°ç³»åˆ—â†’å­£åº¦çš„å±‚çº§å…³ç³» |
| ç²’åº¦æ··æ·† | ç¤¾åª’æ•°æ®æ˜¯ç³»åˆ—çº§ï¼ŒAniList æ•°æ®å¯åŒºåˆ†å­£åº¦ï¼Œä½† UI æ— åŒºåˆ† |

### è§£å†³æ–¹æ¡ˆ

1. **å±•å¼€/æŠ˜å å±‚çº§**
   - ç³»åˆ—ä¸»è¡Œå·¦ä¾§æ·»åŠ å±•å¼€æŒ‰é’®ï¼ˆâ–¶/â–¼ï¼‰
   - ç‚¹å‡»å±•å¼€åæ˜¾ç¤ºè¯¥ç³»åˆ—æ‰€æœ‰å·²å®¡æ ¸çš„å­£åº¦æ•°æ®
   - æœ‰å¤šå­£æ—¶åœ¨æ ‡é¢˜æ—æ˜¾ç¤ºã€ŒX å­£ã€å¾½ç« 

2. **æ•°æ®ç²’åº¦æ ‡æ³¨**
   - ç¬¬ä¸‰è¡Œ AniList æ•°æ®æ—æ˜¾ç¤ºã€Œç³»åˆ—çº§ã€æ ‡ç­¾
   - ç¬¬å››è¡Œç¤¾åª’çƒ­åº¦æ—æ˜¾ç¤ºã€Œç³»åˆ—çº§ã€æ ‡ç­¾
   - å±•å¼€çš„å­£åº¦è¡Œæ˜¾ç¤ºã€Œå­£åº¦çº§ã€æ ‡ç­¾
   - è¯¦æƒ…å¼¹çª—å„åŒºå—ä¹Ÿæœ‰ç›¸åº”æ ‡æ³¨

### æ•°æ®ç²’åº¦è¯´æ˜

| æ•°æ®æº | ç²’åº¦ | è¯´æ˜ |
|-------|-----|------|
| Reddit Karma | ç³»åˆ—çº§ | æœç´¢å…³é”®è¯åŒ¹é…æ•´ä¸ªç³»åˆ— |
| Google Trends | ç³»åˆ—çº§ | æœç´¢å…³é”®è¯åŒ¹é…æ•´ä¸ªç³»åˆ— |
| Twitter/X | ç³»åˆ—çº§ | æœç´¢å…³é”®è¯åŒ¹é…æ•´ä¸ªç³»åˆ— |
| Bç«™å¼¹å¹• | ç³»åˆ—çº§ | æœç´¢å…³é”®è¯åŒ¹é…æ•´ä¸ªç³»åˆ— |
| AniList çƒ­åº¦/è¯„åˆ† | å­£åº¦çº§ | æ¯ä¸ª Entry æœ‰ç‹¬ç«‹æ•°æ® |
| ç³»åˆ—ç»¼åˆåˆ† | ç³»åˆ—çº§ | èšåˆè®¡ç®— |

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `types/trending.ts` | ä¿®æ”¹ | æ·»åŠ  SeasonEntry ç±»å‹ï¼ŒTrendingListItem æ–°å¢ entries |
| `app/api/trendings/route.ts` | ä¿®æ”¹ | è·å–æ‰€æœ‰ APPROVED å­£åº¦æ•°æ® |
| `app/(dashboard)/trending/page.tsx` | ä¿®æ”¹ | åŒæ­¥æœåŠ¡ç«¯æŸ¥è¯¢é€»è¾‘ |
| `components/trending/data-level-badge.tsx` | æ–°å¢ | æ•°æ®ç²’åº¦æ ‡ç­¾ç»„ä»¶ |
| `components/trending/season-entry-row.tsx` | æ–°å¢ | å­£åº¦è¡Œç»„ä»¶ |
| `components/trending/trending-item.tsx` | é‡æ„ | æ·»åŠ å±•å¼€/æŠ˜å åŠŸèƒ½å’Œç²’åº¦æ ‡ç­¾ |

### UI äº¤äº’ç¤ºæ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¶ â”‚ 1 â”‚ å°é¢ â”‚ æ ‡é¢˜ + IPç±»å‹ + [3å­£]                    â”‚ è¯¦æƒ… â”‚
â”‚   â”‚   â”‚      â”‚ ä¸­æ–‡æ ‡é¢˜                                  â”‚ ç”Ÿæˆ â”‚
â”‚   â”‚   â”‚      â”‚ [ç³»åˆ—çº§] AniList ç»¼åˆåˆ† çƒ­åº¦ è¯„åˆ†         â”‚      â”‚
â”‚   â”‚   â”‚      â”‚ [ç³»åˆ—çº§] Reddit X Google Bç«™              â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ ç‚¹å‡»å±•å¼€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¼ â”‚ 1 â”‚ å°é¢ â”‚ ...ï¼ˆåŒä¸Šï¼‰                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       â”‚ ğŸ“º â”‚ [S1] æ ‡é¢˜ ç¬¬ä¸€å­£ â”‚ 2019/04 - 2019/09              â”‚
â”‚       â”‚    â”‚ [å­£åº¦çº§] AniList ç»¼åˆ 90 çƒ­åº¦ 98.5k è¯„åˆ† 8.5      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       â”‚ ğŸ“º â”‚ [S2] æ ‡é¢˜ ç¬¬äºŒå­£ â”‚ 2022/10 - 2023/01              â”‚
â”‚       â”‚    â”‚ [å­£åº¦çº§] AniList ç»¼åˆ 82 çƒ­åº¦ 45.2k è¯„åˆ† 8.0      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å‘å¸ƒä¸­å¿ƒ UI - 2026-01-06 å®Œæˆ

å¤šå¹³å°å†…å®¹å‘å¸ƒç®¡ç†ç•Œé¢ï¼ˆSOP-03ï¼‰ï¼ŒUI è®¾è®¡ + Schemaã€‚

### åŠŸèƒ½æ¸…å•

- [x] æ•°æ®åº“ Schemaï¼šPublishTaskã€PublishPlatformContentã€PublishRecord ä¸‰è¡¨
- [x] ç»Ÿè®¡å¡ç‰‡ï¼šè‰ç¨¿ã€å·²æ’æœŸã€ä»Šæ—¥å·²å‘å¸ƒã€å‘å¸ƒå¤±è´¥
- [x] ä»»åŠ¡åˆ—è¡¨ï¼šæœç´¢ã€çŠ¶æ€ç­›é€‰ã€å°é¢+æ ‡é¢˜+å¹³å°å›¾æ ‡+çŠ¶æ€å¾½ç« 
- [x] ä»»åŠ¡è¯¦æƒ…é¢æ¿ï¼šå¹³å°é€‰æ‹©ã€å†…å®¹é¢„è§ˆã€æ–‡æ¡ˆç¼–è¾‘ï¼ˆæŒ‰å¹³å°åˆ† Tabï¼‰ã€å‘å¸ƒè®¾ç½®
- [x] å‘å¸ƒè®°å½•è¡¨æ ¼ï¼šæ—¶é—´ã€å†…å®¹ã€å¹³å°ã€çŠ¶æ€ã€å¤–é“¾

### ç¬¬ä¸€ç‰ˆèŒƒå›´

| å†³ç­–é¡¹ | é€‰æ‹© |
|-------|------|
| å†…å®¹æ¥æº | ç”¨æˆ·æ‰‹åŠ¨ä¸Šä¼ è§†é¢‘/å°é¢ |
| ç›®æ ‡å¹³å° | Instagramã€Threadsã€YouTube |
| AI æ–‡æ¡ˆ | ç¬¬ä¸€ç‰ˆä¸åšï¼Œæ‰‹åŠ¨å¡«å†™ |

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `prisma/schema.prisma` | ä¿®æ”¹ | æ–°å¢å‘å¸ƒç›¸å…³æšä¸¾å’Œ 3 ä¸ªè¡¨ |
| `components/layout/sidebar.tsx` | ä¿®æ”¹ | å¯¼èˆªæ·»åŠ "å‘å¸ƒä¸­å¿ƒ" |
| `types/publish.ts` | æ–°å¢ | å‘å¸ƒæ¨¡å—ç±»å‹å®šä¹‰ |
| `lib/mock/publish.ts` | æ–°å¢ | Mock æ•°æ® |
| `app/(dashboard)/publish/page.tsx` | æ–°å¢ | å‘å¸ƒä¸­å¿ƒé¡µé¢ |
| `components/publish/publish-stats-cards.tsx` | æ–°å¢ | ç»Ÿè®¡å¡ç‰‡ |
| `components/publish/publish-task-list.tsx` | æ–°å¢ | ä»»åŠ¡åˆ—è¡¨ |
| `components/publish/publish-task-item.tsx` | æ–°å¢ | ä»»åŠ¡å¡ç‰‡ |
| `components/publish/publish-task-detail.tsx` | æ–°å¢ | è¯¦æƒ…é¢æ¿ |
| `components/publish/publish-record-table.tsx` | æ–°å¢ | å‘å¸ƒè®°å½•è¡¨æ ¼ |

### å¹³å° API å¯¹æ¥æƒ…å†µï¼ˆåç»­å¼€å‘ï¼‰

| å¹³å° | å®˜æ–¹ API | å®šæ—¶å‘å¸ƒæ”¯æŒ | å¤‡æ³¨ |
|------|----------|-------------|------|
| YouTube | âœ… æœ‰ | âœ… æ”¯æŒ | YouTube Data API v3ï¼Œéœ€ OAuth 2.0 |
| Instagram | âš ï¸ æœ‰é™ | âœ… æ”¯æŒ | ä»…å•†ä¸šè´¦æˆ·ï¼Œé€šè¿‡ Meta Graph API |
| Threads | âœ… æœ‰ | âœ… æ”¯æŒ | ä¸ Instagram åŒç”Ÿæ€ |
| TikTok | âœ… æœ‰ | âœ… æ”¯æŒ | TikTok for Developersï¼Œéœ€ä¼ä¸šè®¤è¯ |
| X (Twitter) | âœ… æœ‰ | âŒ ä¸æ”¯æŒ | éœ€ç¬¬ä¸‰æ–¹æœåŠ¡æˆ–è‡ªå»ºè°ƒåº¦ |

---

## å‘å¸ƒä¸­å¿ƒåŠŸèƒ½å®ç° - 2026-01-06 å®Œæˆ

å°†å‘å¸ƒä¸­å¿ƒ UI è¿æ¥åˆ°çœŸå®æ•°æ®åº“å’Œ APIï¼Œå®ç°å®Œæ•´ CRUD + n8n å·¥ä½œæµéª¨æ¶ã€‚

### åŠŸèƒ½æ¸…å•

- [x] å®Œæ•´ CRUD APIï¼ˆä»»åŠ¡åˆ—è¡¨/åˆ›å»º/è¯¦æƒ…/æ›´æ–°/åˆ é™¤ï¼‰
- [x] ç»Ÿè®¡æ•°æ® APIï¼ˆè‰ç¨¿/å·²æ’æœŸ/ä»Šæ—¥å‘å¸ƒ/å¤±è´¥æ•°ï¼‰
- [x] æ–°å»ºä»»åŠ¡å¼¹çª—ï¼ˆæ ‡é¢˜ã€è§†é¢‘/å°é¢ URLã€ç›®æ ‡å¹³å°ã€å‘å¸ƒæ¨¡å¼ã€æ’æœŸæ—¶é—´ï¼‰
- [x] è¯¦æƒ…é¢æ¿ç¼–è¾‘åŠŸèƒ½ï¼ˆå¹³å°æ–‡æ¡ˆç¼–è¾‘ã€ä¿å­˜ã€å‘å¸ƒã€åˆ é™¤ï¼‰
- [x] è§¦å‘å‘å¸ƒ API + n8n å›è°ƒ API
- [x] n8n å·¥ä½œæµéª¨æ¶ï¼ˆè§¦å‘ â†’ æ¨¡æ‹Ÿå»¶è¿Ÿ â†’ è¿”å›ç»“æœï¼‰

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `app/api/publish/schema.ts` | æ–°å¢ | Zod Schema å®šä¹‰ |
| `app/api/publish/route.ts` | æ–°å¢ | GET åˆ—è¡¨ + POST åˆ›å»º |
| `app/api/publish/stats/route.ts` | æ–°å¢ | ç»Ÿè®¡æ•°æ® API |
| `app/api/publish/[id]/route.ts` | æ–°å¢ | GET/PATCH/DELETE |
| `app/api/publish/[id]/trigger/route.ts` | æ–°å¢ | è§¦å‘å‘å¸ƒ |
| `app/api/publish/[id]/platform-content/route.ts` | æ–°å¢ | æ›´æ–°å¹³å°æ–‡æ¡ˆ |
| `app/api/publish/callback/route.ts` | æ–°å¢ | n8n å›è°ƒ |
| `components/publish/create-task-dialog.tsx` | æ–°å¢ | æ–°å»ºä»»åŠ¡å¼¹çª— |
| `components/ui/form.tsx` | æ–°å¢ | shadcn Form ç»„ä»¶ |
| `app/(dashboard)/publish/page.tsx` | ä¿®æ”¹ | æ›¿æ¢ Mock ä¸º API |
| `components/publish/publish-task-detail.tsx` | ä¿®æ”¹ | å¯ç”¨ç¼–è¾‘åŠŸèƒ½ |
| `n8n-workflows/sop-05-publish-content.json` | æ–°å¢ | å‘å¸ƒå·¥ä½œæµï¼ˆWebhookï¼‰ |
| `n8n-workflows/sop-06-schedule-check.json` | æ–°å¢ | å®šæ—¶æ£€æŸ¥å·¥ä½œæµ |

### n8n å·¥ä½œæµ

| æ–‡ä»¶ | è§¦å‘æ–¹å¼ | åŠŸèƒ½ |
|------|---------|------|
| `sop-05-publish-content.json` | Webhook | æ‰§è¡Œå†…å®¹å‘å¸ƒï¼ˆéª¨æ¶ç‰ˆï¼Œ90%æˆåŠŸç‡æ¨¡æ‹Ÿï¼‰ |
| `sop-06-schedule-check.json` | æ¯åˆ†é’Ÿ Schedule | æ£€æŸ¥åˆ°æœŸçš„å®šæ—¶å‘å¸ƒä»»åŠ¡ |

### çŠ¶æ€æµè½¬

```
DRAFT â”€â”€[è®¾ç½®æ’æœŸ]â”€â”€â–º SCHEDULED
  â”‚                      â”‚
  â””â”€â”€[ç«‹å³å‘å¸ƒ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                         â”‚
                  [è§¦å‘å‘å¸ƒ]
                         â†“
                    PUBLISHING
                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                    â†“                    â†“
PUBLISHED         PARTIAL_FAILED           FAILED
                         â”‚                    â”‚
                         â””â”€â”€[é‡è¯•]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¾èµ–å®‰è£…

```bash
npm install react-hook-form @hookform/resolvers
npx shadcn@latest add form
```

### ä½¿ç”¨å‰æ

1. è¿è¡Œ `npx prisma db push` åŒæ­¥æ•°æ®åº“
2. åœ¨ n8n å¯¼å…¥ `sop-05-publish-content.json` å¹¶é…ç½® `NEXTJS_URL` ç¯å¢ƒå˜é‡
3. æ¿€æ´»å·¥ä½œæµåå³å¯ä½¿ç”¨

---

## ç¤¾åª’è´¦å·ç®¡ç† - 2026-01-06 å®Œæˆ

å¤šè´¦å·å¤šå¹³å°ç®¡ç†æ¨¡å—ï¼Œæ”¯æŒç”¨æˆ·ç»‘å®šå¤šä¸ªç¤¾åª’è´¦å·å¹¶åœ¨å‘å¸ƒä»»åŠ¡ä¸­é€‰æ‹©ã€‚

### åŠŸèƒ½æ¸…å•

- [x] æ•°æ®åº“ Schemaï¼šSocialAccountã€PublishTaskAccount è¡¨
- [x] å®Œæ•´ CRUD APIï¼ˆè´¦å·åˆ—è¡¨/åˆ›å»º/è¯¦æƒ…/æ›´æ–°/åˆ é™¤ï¼‰
- [x] ç»Ÿè®¡æ•°æ® APIï¼ˆæ€»æ•°/æ­£å¸¸/è¿‡æœŸ/ç¦ç”¨/æŒ‰å¹³å°åˆ†å¸ƒï¼‰
- [x] è´¦å·ç®¡ç†é¡µé¢ï¼ˆTab æŒ‰å¹³å°ç­›é€‰ã€è¡¨æ ¼å±•ç¤ºã€æ“ä½œèœå•ï¼‰
- [x] æ·»åŠ è´¦å·å¼¹çª—ï¼ˆæ‰‹åŠ¨å¡«å†™ + OAuth å ä½ï¼‰
- [x] ç¼–è¾‘è´¦å·å¼¹çª—
- [x] è´¦å·é€‰æ‹©å™¨ï¼ˆé›†æˆåˆ°åˆ›å»ºå‘å¸ƒä»»åŠ¡å¼¹çª—ï¼‰
- [x] ä¾§è¾¹æ è®¾ç½®å¯¼èˆª

### æ•°æ®æ¨¡å‹

```prisma
enum SocialAccountStatus {
  PENDING      // å¾…éªŒè¯
  ACTIVE       // æ­£å¸¸
  EXPIRED      // æˆæƒè¿‡æœŸ
  DISABLED     // å·²ç¦ç”¨
}

model SocialAccount {
  id            String              @id @default(cuid())
  userId        String
  platform      PublishPlatform
  accountName   String              // å¦‚ @moedesk_official
  accountId     String?             // å¹³å°è´¦å· IDï¼ˆOAuth è·å–ï¼‰
  accountUrl    String?             // ä¸»é¡µé“¾æ¥
  avatarUrl     String?
  accessToken   String?             // é¢„ç•™ OAuth
  refreshToken  String?
  tokenExpiry   DateTime?
  status        SocialAccountStatus @default(ACTIVE)
  lastUsedAt    DateTime?
  createdAt     DateTime            @default(now())
  updatedAt     DateTime            @updatedAt

  taskAccounts   PublishTaskAccount[]
  publishRecords PublishRecord[]

  @@unique([userId, platform, accountName])
  @@map("social_accounts")
}

model PublishTaskAccount {
  id          String        @id @default(cuid())
  taskId      String
  accountId   String
  task        PublishTask   @relation(...)
  account     SocialAccount @relation(...)
  createdAt   DateTime      @default(now())

  @@unique([taskId, accountId])
  @@map("publish_task_accounts")
}
```

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `prisma/schema.prisma` | ä¿®æ”¹ | æ–°å¢ SocialAccountStatusã€SocialAccountã€PublishTaskAccount |
| `types/social-account.ts` | æ–°å¢ | è´¦å·æ¨¡å—ç±»å‹å®šä¹‰ |
| `types/publish.ts` | ä¿®æ”¹ | PublishTask/PublishRecord æ·»åŠ è´¦å·å…³è” |
| `app/api/accounts/schema.ts` | æ–°å¢ | Zod Schema å®šä¹‰ |
| `app/api/accounts/route.ts` | æ–°å¢ | GET åˆ—è¡¨ + POST åˆ›å»º |
| `app/api/accounts/stats/route.ts` | æ–°å¢ | ç»Ÿè®¡æ•°æ® API |
| `app/api/accounts/[id]/route.ts` | æ–°å¢ | GET/PATCH/DELETE |
| `app/api/accounts/[id]/toggle-status/route.ts` | æ–°å¢ | å¯ç”¨/ç¦ç”¨åˆ‡æ¢ |
| `app/api/accounts/by-platform/[platform]/route.ts` | æ–°å¢ | æŒ‰å¹³å°è·å–ï¼ˆä»»åŠ¡åˆ›å»ºç”¨ï¼‰ |
| `app/(dashboard)/settings/accounts/page.tsx` | æ–°å¢ | è´¦å·ç®¡ç†é¡µé¢ |
| `components/settings/accounts/account-list.tsx` | æ–°å¢ | è´¦å·è¡¨æ ¼ |
| `components/settings/accounts/add-account-dialog.tsx` | æ–°å¢ | æ·»åŠ è´¦å·å¼¹çª— |
| `components/settings/accounts/edit-account-dialog.tsx` | æ–°å¢ | ç¼–è¾‘è´¦å·å¼¹çª— |
| `components/settings/accounts/account-selector.tsx` | æ–°å¢ | è´¦å·é€‰æ‹©å™¨ |
| `components/publish/create-task-dialog.tsx` | ä¿®æ”¹ | é›†æˆè´¦å·é€‰æ‹©å™¨ |
| `components/layout/sidebar.tsx` | ä¿®æ”¹ | æ·»åŠ è®¾ç½®å¯¼èˆª |

### é¡µé¢ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è´¦å·ç®¡ç†                              [åˆ·æ–°] [æ·»åŠ è´¦å·]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç»Ÿè®¡å¡ç‰‡ï¼šæ€»æ•° | æ­£å¸¸ | å·²è¿‡æœŸ | å·²ç¦ç”¨                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Tab: å…¨éƒ¨ | Instagram | Threads | YouTube                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  è´¦å·è¡¨æ ¼                                               â”‚â”‚
â”‚  â”‚  å¤´åƒ | è´¦å·å | å¹³å° | çŠ¶æ€ | æœ€åä½¿ç”¨ | æ“ä½œ           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### OAuth é›†æˆçŠ¶æ€

| å¹³å° | OAuth æ”¯æŒ | çŠ¶æ€ | å¤‡æ³¨ |
|------|-----------|------|------|
| YouTube | âœ… Google OAuth 2.0 | âœ… å·²å®Œæˆ | YouTube Data API v3 |
| Instagram | âœ… Meta Graph API | â³ å¾…å¼€å‘ | éœ€å•†ä¸šè´¦æˆ· |
| Threads | âœ… Meta Graph API | â³ å¾…å¼€å‘ | ä¸ Instagram åŒç”Ÿæ€ |

---

## YouTube OAuth é›†æˆ - 2026-01-06 å®Œæˆ

å®ç° YouTube è´¦å·çš„ OAuth 2.0 æˆæƒï¼Œæ”¯æŒçœŸå®ç»‘å®š YouTube é¢‘é“å¹¶è·å–ç»Ÿè®¡æ•°æ®ã€‚

### åŠŸèƒ½æ¸…å•

- [x] Google OAuth 2.0 æˆæƒæµç¨‹ï¼ˆæˆæƒå‘èµ· â†’ å›è°ƒå¤„ç†ï¼‰
- [x] Token åŠ å¯†å­˜å‚¨ï¼ˆAES-256-GCMï¼‰
- [x] è·å– YouTube é¢‘é“ä¿¡æ¯ï¼ˆåç§°ã€å¤´åƒã€URLï¼‰
- [x] è·å–é¢‘é“ç»Ÿè®¡æ•°æ®ï¼ˆè®¢é˜…æ•°ã€è§†é¢‘æ•°ã€æ’­æ”¾é‡ï¼‰
- [x] æ”¯æŒæ— é¢‘é“è´¦å·ç»‘å®šï¼ˆæ˜¾ç¤º"å¾…åˆ›å»ºé¢‘é“"ï¼‰
- [x] æˆæƒæˆåŠŸ/å¤±è´¥æ¶ˆæ¯æç¤º
- [x] Docker ç¯å¢ƒæ”¯æŒ

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `lib/crypto.ts` | æ–°å¢ | Token åŠ å¯†/è§£å¯†å·¥å…·ï¼ˆAES-256-GCMï¼‰ |
| `app/api/oauth/youtube/authorize/route.ts` | æ–°å¢ | OAuth æˆæƒå‘èµ· API |
| `app/api/oauth/youtube/callback/route.ts` | æ–°å¢ | OAuth å›è°ƒå¤„ç† API |
| `components/ui/alert.tsx` | æ–°å¢ | shadcn Alert ç»„ä»¶ |
| `prisma/schema.prisma` | ä¿®æ”¹ | SocialAccount æ·»åŠ  channelStats å­—æ®µ |
| `types/social-account.ts` | ä¿®æ”¹ | æ·»åŠ  YouTubeChannelStats ç±»å‹ |
| `components/settings/accounts/add-account-dialog.tsx` | ä¿®æ”¹ | å®ç° YouTube OAuth æˆæƒæŒ‰é’® |
| `components/settings/accounts/account-list.tsx` | ä¿®æ”¹ | å±•ç¤ºé¢‘é“ç»Ÿè®¡æ•°æ® |
| `app/(dashboard)/settings/accounts/page.tsx` | ä¿®æ”¹ | å¤„ç†æˆæƒå›è°ƒæ¶ˆæ¯æç¤º |
| `docker-compose.yml` | ä¿®æ”¹ | æ·»åŠ  env_file å¼•ç”¨ |
| `.env` | ä¿®æ”¹ | æ·»åŠ  Google OAuth é…ç½® |
| `.env.docker` | æ–°å¢ | Docker ç¯å¢ƒå˜é‡é…ç½® |

### ç¯å¢ƒå˜é‡é…ç½®

```env
# Google OAuth é…ç½®
GOOGLE_CLIENT_ID="your-client-id.apps.googleusercontent.com"
GOOGLE_CLIENT_SECRET="your-client-secret"
GOOGLE_REDIRECT_URI="http://localhost:3443/api/oauth/youtube/callback"

# Token åŠ å¯†å¯†é’¥ï¼ˆ32 å­—èŠ‚ hexï¼‰
TOKEN_ENCRYPTION_KEY="64ä½hexå­—ç¬¦ä¸²"
```

### Google Cloud Console é…ç½®

1. å¯ç”¨ **YouTube Data API v3**
2. åˆ›å»º **OAuth 2.0 å®¢æˆ·ç«¯ ID**ï¼ˆWeb åº”ç”¨ç±»å‹ï¼‰
3. æ·»åŠ æˆæƒé‡å®šå‘ URI
4. é…ç½® **OAuth åŒæ„å±å¹•**ï¼Œæ·»åŠ æµ‹è¯•ç”¨æˆ·

### OAuth æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»ã€ŒYouTube æˆæƒã€æŒ‰é’®
        â†“
GET /api/oauth/youtube/authorize
        â†“
ç”Ÿæˆ state å‚æ•°ï¼Œå­˜å…¥ HttpOnly Cookie
        â†“
é‡å®šå‘åˆ° Google æˆæƒé¡µé¢
        â†“
ç”¨æˆ·æˆæƒåå›è°ƒ /api/oauth/youtube/callback
        â†“
éªŒè¯ state â†’ æ¢å– Token â†’ è·å–é¢‘é“ä¿¡æ¯
        â†“
åŠ å¯†å­˜å‚¨ Tokenï¼Œåˆ›å»º/æ›´æ–° SocialAccount
        â†“
é‡å®šå‘å›è´¦å·ç®¡ç†é¡µé¢ï¼Œæ˜¾ç¤ºæˆåŠŸæç¤º
```

### å®‰å…¨æªæ–½

- CSRF é˜²æŠ¤ï¼šstate å‚æ•°å­˜å‚¨åœ¨ HttpOnly Cookie
- Token åŠ å¯†ï¼šAES-256-GCM åŠ å¯†åå­˜å‚¨åˆ°æ•°æ®åº“
- æƒé™éªŒè¯ï¼šæ‰€æœ‰ API éªŒè¯ session å’Œè´¦å·æ‰€æœ‰æƒ

---

## YouTube OAuth åŠŸèƒ½å®Œå–„ - 2026-01-06 å®Œæˆ

åœ¨åŸºç¡€ OAuth è®¤è¯åŸºç¡€ä¸Šï¼Œæ–°å¢ Google è´¦æˆ·ä¿¡æ¯è·å–ã€å¤šé¢‘é“é€‰æ‹©ã€Token è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½ã€‚

### åŠŸèƒ½æ¸…å•

- [x] è·å– Google è´¦æˆ·ä¿¡æ¯ï¼ˆé‚®ç®±ã€ç”¨æˆ·åï¼‰- æ‰€æœ‰è´¦å·éƒ½æ˜¾ç¤º
- [x] å¤šé¢‘é“é€‰æ‹©æ”¯æŒï¼ˆå“ç‰Œè´¦å·ï¼‰
- [x] Token è‡ªåŠ¨åˆ·æ–°æœºåˆ¶
- [x] æ— é¢‘é“è´¦å·ç»‘å®šä¼˜åŒ–ï¼ˆæ˜¾ç¤º Google è´¦æˆ·åï¼‰
- [x] è´¦å·åˆ—è¡¨ UI ä¼˜åŒ–ï¼ˆæ˜¾ç¤º Google é‚®ç®±ã€è¿‡æœŸæç¤ºï¼‰

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `prisma/schema.prisma` | ä¿®æ”¹ | SocialAccount æ·»åŠ  googleAccountId/googleEmail/googleName |
| `types/social-account.ts` | ä¿®æ”¹ | æ·»åŠ  Google è´¦æˆ·ä¿¡æ¯å­—æ®µ |
| `lib/youtube.ts` | æ–°å¢ | YouTube API å°è£…ï¼ˆToken åˆ·æ–°ã€é¢‘é“è·å–ï¼‰ |
| `lib/crypto.ts` | ä¿®æ”¹ | æ·»åŠ ä¸´æ—¶æ•°æ®åŠ å¯†å‡½æ•° |
| `app/api/oauth/youtube/authorize/route.ts` | ä¿®æ”¹ | æ·»åŠ  openid/email/profile scope |
| `app/api/oauth/youtube/callback/route.ts` | é‡å†™ | å¤šé¢‘é“æ£€æµ‹ã€Google ç”¨æˆ·ä¿¡æ¯è·å– |
| `app/api/oauth/youtube/confirm-channels/route.ts` | æ–°å¢ | ç¡®è®¤å¤šé¢‘é“é€‰æ‹© API |
| `app/api/accounts/[id]/refresh-token/route.ts` | æ–°å¢ | æ‰‹åŠ¨åˆ·æ–° Token API |
| `app/api/accounts/route.ts` | ä¿®æ”¹ | è¿”å› Google è´¦æˆ·ä¿¡æ¯å­—æ®µ |
| `app/(dashboard)/settings/accounts/select-channel/page.tsx` | æ–°å¢ | å¤šé¢‘é“é€‰æ‹©é¡µé¢ |
| `components/settings/accounts/channel-selector.tsx` | æ–°å¢ | é¢‘é“é€‰æ‹©å™¨ç»„ä»¶ |
| `components/settings/accounts/account-list.tsx` | ä¿®æ”¹ | æ˜¾ç¤º Google é‚®ç®±ã€åˆ·æ–° Tokenã€è¿‡æœŸæç¤º |
| `app/(dashboard)/settings/accounts/page.tsx` | ä¿®æ”¹ | å¤„ç†æ–°çš„å›è°ƒæ¶ˆæ¯ç±»å‹ |

### OAuth æµç¨‹æ›´æ–°

```
ç”¨æˆ·ç‚¹å‡»ã€ŒYouTube æˆæƒã€æŒ‰é’®
        â†“
GET /api/oauth/youtube/authorize
        â†“
è¯·æ±‚ scope: openid, email, profile, youtube.readonly, youtube.upload
        â†“
Google æˆæƒé¡µé¢
        â†“
å›è°ƒ /api/oauth/youtube/callback
        â†“
1. è·å– Google ç”¨æˆ·ä¿¡æ¯ï¼ˆé‚®ç®±ã€ç”¨æˆ·åï¼‰
2. è·å–æ‰€æœ‰ YouTube é¢‘é“
        â†“
â”œâ”€â”€ 0 ä¸ªé¢‘é“ â†’ åˆ›å»ºæ— é¢‘é“è´¦å·ï¼ˆæ˜¾ç¤º Google ç”¨æˆ·åï¼‰
â”œâ”€â”€ 1 ä¸ªé¢‘é“ â†’ ç›´æ¥ç»‘å®š
â””â”€â”€ å¤šä¸ªé¢‘é“ â†’ è·³è½¬é€‰æ‹©é¡µé¢ /settings/accounts/select-channel
```

### Token åˆ·æ–°æœºåˆ¶

```typescript
// å‘å¸ƒå‰è‡ªåŠ¨æ£€æŸ¥å¹¶åˆ·æ–°
const accessToken = await getValidAccessToken(accountId)
// 1. Token æœªè¿‡æœŸ â†’ ç›´æ¥è¿”å›
// 2. Token å·²è¿‡æœŸ â†’ ä½¿ç”¨ refresh_token åˆ·æ–°
// 3. åˆ·æ–°å¤±è´¥ â†’ æ›´æ–°çŠ¶æ€ä¸º EXPIREDï¼Œè¿”å› null
```

### Google Cloud Console é…ç½®æ›´æ–°

éœ€è¦åœ¨ OAuth åŒæ„å±å¹•ä¸­æ·»åŠ ä»¥ä¸‹ scopeï¼š
- `openid` - OpenID Connect
- `email` - ç”¨æˆ·é‚®ç®±
- `profile` - ç”¨æˆ·åŸºæœ¬ä¿¡æ¯

---

## å‘å¸ƒä¸­å¿ƒ YouTube é…ç½®å®Œå–„ - 2026-01-06 å®Œæˆ

å®Œå–„å‘å¸ƒä¸­å¿ƒå¯¹ YouTube çš„æ”¯æŒï¼ŒåŒ…æ‹¬æ— é¢‘é“è´¦å·å¤„ç†å’Œå‘å¸ƒå‰é…ç½®é¡¹ã€‚

### åŠŸèƒ½æ¸…å•

- [x] YouTube æ— é¢‘é“è´¦å·åœ¨è´¦å·é€‰æ‹©å™¨ä¸­æ˜¾ç¤ºã€Œå¾…åˆ›å»ºé¢‘é“ã€å¾½ç« å¹¶ç¦ç”¨é€‰æ‹©
- [x] YouTube éšç§è®¾ç½®ï¼ˆå…¬å¼€/ä¸å…¬å¼€/ç§äº«ï¼‰- åˆ›å»ºå¼¹çª— + è¯¦æƒ…é¢æ¿
- [x] YouTube è§†é¢‘åˆ†ç±» - è¯¦æƒ…é¢æ¿
- [x] YouTube æ’­æ”¾åˆ—è¡¨å¤šé€‰ - è¯¦æƒ…é¢æ¿
- [x] YouTube è‡ªå®šä¹‰ç¼©ç•¥å›¾ URL + é¢„è§ˆ - è¯¦æƒ…é¢æ¿
- [x] æ‰€æœ‰é…ç½®æ”¯æŒè‰ç¨¿æ¨¡å¼ï¼ˆå­—æ®µå¯ç©ºï¼‰

### æ•°æ®æ¨¡å‹å˜æ›´

```prisma
model PublishPlatformContent {
  // ... ç°æœ‰å­—æ®µ

  // YouTube ä¸“å±é…ç½®
  youtubePrivacyStatus   String?   @map("youtube_privacy_status")   // public/unlisted/private
  youtubeCategoryId      String?   @map("youtube_category_id")      // è§†é¢‘åˆ†ç±» ID
  youtubePlaylistIds     String[]  @default([]) @map("youtube_playlist_ids")  // æ’­æ”¾åˆ—è¡¨ ID åˆ—è¡¨
  youtubeThumbnailUrl    String?   @map("youtube_thumbnail_url")    // ç¼©ç•¥å›¾ URL
}
```

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `prisma/schema.prisma` | ä¿®æ”¹ | PublishPlatformContent æ·»åŠ  YouTube ä¸“å±å­—æ®µ |
| `types/publish.ts` | ä¿®æ”¹ | æ–°å¢ YouTubePrivacyStatusã€YouTubeCategoryã€YouTubePlaylist ç±»å‹ |
| `types/social-account.ts` | ä¿®æ”¹ | AccountBrief æ·»åŠ  hasChannel å­—æ®µ |
| `lib/youtube.ts` | ä¿®æ”¹ | æ–°å¢ getYouTubeCategoriesã€getYouTubePlaylists å‡½æ•° |
| `app/api/youtube/categories/route.ts` | æ–°å¢ | YouTube è§†é¢‘åˆ†ç±» API |
| `app/api/youtube/playlists/route.ts` | æ–°å¢ | YouTube æ’­æ”¾åˆ—è¡¨ APIï¼ˆéœ€ accountIdï¼‰ |
| `app/api/accounts/by-platform/[platform]/route.ts` | ä¿®æ”¹ | è¿”å› hasChannel å­—æ®µ |
| `app/api/publish/schema.ts` | ä¿®æ”¹ | æ‰©å±• PlatformContentInput/UpdatePlatformContentReq |
| `app/api/publish/route.ts` | ä¿®æ”¹ | åˆ›å»ºä»»åŠ¡æ”¯æŒ YouTube é…ç½® |
| `app/api/publish/[id]/route.ts` | ä¿®æ”¹ | è¿”å› YouTube é…ç½®å­—æ®µ |
| `app/api/publish/[id]/platform-content/route.ts` | ä¿®æ”¹ | æ›´æ–°æ–‡æ¡ˆæ”¯æŒ YouTube é…ç½® |
| `components/settings/accounts/account-selector.tsx` | ä¿®æ”¹ | æ— é¢‘é“è´¦å·æ˜¾ç¤ºå¾½ç« å¹¶ç¦ç”¨ |
| `components/publish/create-task-dialog.tsx` | ä¿®æ”¹ | æ·»åŠ  YouTube éšç§è®¾ç½®é€‰é¡¹ |
| `components/publish/publish-task-detail.tsx` | ä¿®æ”¹ | YouTube Tab æ·»åŠ é«˜çº§è®¾ç½®åŒºåŸŸ |

### UI é…ç½®ä½ç½®

| é…ç½®é¡¹ | åˆ›å»ºå¼¹çª— | è¯¦æƒ…é¢æ¿ | è¯´æ˜ |
|--------|----------|----------|------|
| éšç§è®¾ç½® | âœ… RadioGroup | âœ… Select | å¿…å¡«é¡¹ï¼Œé»˜è®¤ã€Œå…¬å¼€ã€ |
| è§†é¢‘åˆ†ç±» | - | âœ… Select | å¯é€‰ï¼Œè°ƒç”¨ YouTube API |
| æ’­æ”¾åˆ—è¡¨ | - | âœ… Checkbox å¤šé€‰ | å¯é€‰ï¼Œéœ€å…³è”è´¦å· |
| è‡ªå®šä¹‰ç¼©ç•¥å›¾ | - | âœ… URL è¾“å…¥ + é¢„è§ˆ | æ¨è 1280x720 |

### ç¯å¢ƒå˜é‡

```env
# YouTube åˆ†ç±» API éœ€è¦ï¼ˆå…¬å¼€æ¥å£ï¼‰
GOOGLE_API_KEY="your-api-key"
```

### æ³¨æ„äº‹é¡¹

1. **åˆ†ç±» API** ä½¿ç”¨ `GOOGLE_API_KEY`ï¼ˆå…¬å¼€ APIï¼‰ï¼Œä¸éœ€è¦ OAuth
2. **æ’­æ”¾åˆ—è¡¨ API** éœ€è¦ç”¨æˆ· OAuth Tokenï¼Œé€šè¿‡ accountId è·å–
3. **ç¼©ç•¥å›¾** ä»…å­˜å‚¨ URLï¼Œå®é™…ä¸Šä¼ ç”± n8n å·¥ä½œæµå¤„ç†
4. **è‰ç¨¿æ¨¡å¼** æ‰€æœ‰ YouTube é…ç½®å­—æ®µå‡å¯ä¸ºç©º

---

## YouTube åˆ·æ–°é¢‘é“åŠŸèƒ½ - 2026-01-06 å®Œæˆ

ä¸º YouTube è´¦å·æ·»åŠ "åˆ·æ–°é¢‘é“ä¿¡æ¯"åŠŸèƒ½ï¼Œæ”¯æŒåˆ·æ–°é¢‘é“å®Œæ•´ä¿¡æ¯ï¼ˆåç§°ã€å¤´åƒã€ç»Ÿè®¡æ•°æ®ï¼‰å’Œæ£€æµ‹æ–°åˆ›å»ºçš„é¢‘é“ã€‚

### åŠŸèƒ½æ¸…å•

- [x] åˆ·æ–°é¢‘é“ APIï¼šåˆ·æ–°é¢‘é“å®Œæ•´ä¿¡æ¯æˆ–æ£€æµ‹æ–°åˆ›å»ºçš„é¢‘é“
- [x] å·²ç»‘å®šé¢‘é“è´¦å·ï¼šç›´æ¥åˆ·æ–°å½“å‰ç»‘å®šé¢‘é“çš„ä¿¡æ¯
- [x] æ— é¢‘é“è´¦å· + å•é¢‘é“ï¼šè‡ªåŠ¨ç»‘å®š
- [x] æ— é¢‘é“è´¦å· + å¤šé¢‘é“ï¼šè·³è½¬é€‰æ‹©é¡µé¢ï¼ˆå•é€‰æ¨¡å¼ï¼‰
- [x] åŠ è½½çŠ¶æ€ï¼šåˆ·æ–°æ—¶è¡¨æ ¼è¡ŒåŠé€æ˜
- [x] Toast é€šçŸ¥ï¼šä½¿ç”¨ sonner æ˜¾ç¤ºæ“ä½œç»“æœ

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `app/api/accounts/[id]/refresh-channel/route.ts` | æ–°å¢ | åˆ·æ–°é¢‘é“ä¿¡æ¯ API |
| `app/api/oauth/youtube/confirm-channels/route.ts` | ä¿®æ”¹ | æ”¯æŒæ›´æ–°ç°æœ‰è´¦å·ï¼ˆåˆ·æ–°æ¨¡å¼ï¼‰ |
| `app/(dashboard)/settings/accounts/select-channel/page.tsx` | ä¿®æ”¹ | æ”¯æŒåˆ·æ–°æ¨¡å¼ï¼ˆå•é€‰ï¼‰ |
| `components/settings/accounts/channel-selector.tsx` | ä¿®æ”¹ | æ–°å¢ singleSelect å•é€‰æ¨¡å¼ |
| `components/settings/accounts/account-list.tsx` | ä¿®æ”¹ | ç»Ÿä¸€åˆ·æ–°æŒ‰é’®ã€åŠ è½½çŠ¶æ€ã€toast é€šçŸ¥ |
| `app/(dashboard)/settings/accounts/page.tsx` | ä¿®æ”¹ | æ·»åŠ  channel_refreshed æˆåŠŸæ¶ˆæ¯ |
| `components/ui/sonner.tsx` | æ–°å¢ | shadcn sonner toast ç»„ä»¶ |
| `app/layout.tsx` | ä¿®æ”¹ | æ·»åŠ å…¨å±€ Toaster |

### æµç¨‹è¯´æ˜

```
ç”¨æˆ·ç‚¹å‡»"åˆ·æ–°é¢‘é“ä¿¡æ¯"/"åˆ·æ–°é¢‘é“"
        â†“
POST /api/accounts/{id}/refresh-channel
        â†“
è·å– Access Token â†’ è°ƒç”¨ YouTube API
        â†“
â”œâ”€â”€ å·²ç»‘å®šé¢‘é“ â†’ ç›´æ¥åˆ·æ–°è¯¥é¢‘é“ä¿¡æ¯ â†’ toast æˆåŠŸ
â”œâ”€â”€ 0 ä¸ªé¢‘é“ â†’ toast è­¦å‘Š"æš‚æ— é¢‘é“"
â”œâ”€â”€ 1 ä¸ªé¢‘é“ â†’ ç›´æ¥ç»‘å®š â†’ toast æˆåŠŸ
â””â”€â”€ å¤šä¸ªé¢‘é“ â†’ è·³è½¬é€‰æ‹©é¡µé¢ï¼ˆå•é€‰ï¼‰â†’ ç¡®è®¤åæ›´æ–°è´¦å·
```

### Toast é€šçŸ¥

ä½¿ç”¨ sonnerï¼ˆshadcn æ¨èï¼‰æ›¿ä»£æµè§ˆå™¨ alertï¼š

```tsx
import { toast } from "sonner"

toast.success("é¢‘é“ä¿¡æ¯åˆ·æ–°æˆåŠŸ")
toast.warning("è¯¥ Google è´¦å·æš‚æ—  YouTube é¢‘é“")
toast.error("ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•")
```

å…¨å±€é…ç½®ä½äº `app/layout.tsx`ï¼š

```tsx
<Toaster richColors position="top-center" />
```

---

## å¼€å‘è§„èŒƒ

éµå®ˆ `å…¨æ ˆç¼–ç è§„èŒƒ.md`ï¼š
- shadcn/ui ç»„ä»¶ä¼˜å…ˆ
- è¯­ä¹‰åŒ– Tailwind class
- TypeScript ä¸¥æ ¼æ¨¡å¼
- Server Component ä¼˜å…ˆ
